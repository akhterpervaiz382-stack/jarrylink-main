<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>JarryLink | Free SEO-Optimized URL Shortener</title>
    
    <meta name="description" content="JarryLink is a free online link shortener, best bitly alternative. Create custom URL shorteners, paragraph shorteners, and AI video shorteners.">
    <meta name="keywords" content="link shortener free online, url shortener free, custom url shortener, ai video shortener free online, sentence shortener, paragraph shortener, google url shortener free, bitly alternative, best free url shortener, url shortener with custom name">

    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        .glass { background: rgba(255, 255, 255, 0.1); backdrop-filter: blur(10px); }
        #status-dot { transition: all 0.5s ease; }
    </style>
</head>
<body class="bg-slate-900 text-white min-h-screen flex flex-col items-center justify-center p-4">

    <div class="absolute top-5 right-5 flex items-center gap-2 bg-black/40 p-3 rounded-full border border-white/10">
        <div id="status-dot" class="w-3 h-3 rounded-full bg-red-500 shadow-[0_0_10px_#ef4444]"></div>
        <span id="status-text" class="text-xs font-mono uppercase tracking-widest text-gray-300">Engine Offline</span>
    </div>

    <div class="max-w-md w-full glass p-8 rounded-3xl border border-white/20 shadow-2xl text-center">
        <h1 class="text-4xl font-bold mb-2 bg-gradient-to-r from-blue-400 to-emerald-400 bg-clip-text text-transparent">
            JarryLink Architect
        </h1>
        <p class="text-gray-400 mb-8">Create SEO-Optimized Short Links</p>

        <div class="space-y-4 text-left">
            <div>
                <label class="block text-sm mb-1 text-gray-300">Target URL</label>
                <input type="text" id="longUrl" placeholder="https://example.com/very-long-link" 
                       class="w-full p-3 rounded-xl bg-black/20 border border-white/10 focus:border-emerald-500 outline-none">
            </div>
            <div>
                <label class="block text-sm mb-1 text-gray-300">Custom Path (Optional)</label>
                <input type="text" id="shortCode" placeholder="my-custom-name" 
                       class="w-full p-3 rounded-xl bg-black/20 border border-white/10 focus:border-emerald-500 outline-none">
            </div>
            <button onclick="shortenLink()" class="w-full py-4 bg-emerald-600 hover:bg-emerald-500 rounded-xl font-bold transition-all shadow-lg shadow-emerald-900/20">
                Generate & Save to Supabase
            </button>
        </div>

        <div id="result" class="mt-6 hidden p-4 bg-emerald-900/20 border border-emerald-500/30 rounded-xl">
            <p class="text-sm text-emerald-400">Success! Your link is ready:</p>
            <p id="shortUrl" class="font-mono text-lg break-all"></p>
        </div>
    </div>

    <script>
        // VERCEL CONNECTION FIX
        async function checkStatus() {
            const dot = document.getElementById('status-dot');
            const txt = document.getElementById('status-text');
            try {
                // Ab ye seedha Vercel ke /status route ko check karega
                const res = await fetch('/status');
                if(res.ok) {
                    dot.classList.replace('bg-red-500', 'bg-emerald-500');
                    dot.style.boxShadow = "0 0 15px #10b981";
                    txt.innerText = "Architect Engine Online";
                    txt.classList.add('text-emerald-400');
                }
            } catch(e) {
                dot.classList.replace('bg-emerald-500', 'bg-red-500');
                txt.innerText = "Engine Offline (Reconnecting...)";
            }
        }

        async function shortenLink() {
            const original_url = document.getElementById('longUrl').value;
            const short_code = document.getElementById('shortCode').value || Math.random().toString(36).substring(7);
            const btn = event.target;

            if(!original_url) return alert("URL to daalein!");

            btn.innerText = "Architecting...";
            
            try {
                const res = await fetch('/shorten', {
                    method: 'POST',
                    headers: {'Content-Type': 'application/json'},
                    body: JSON.stringify({ original_url, short_code })
                });

                if(res.ok) {
                    document.getElementById('result').classList.remove('hidden');
                    document.getElementById('shortUrl').innerText = `jarrylink.site/${short_code}`;
                    btn.innerText = "Generate & Save to Supabase";
                }
            } catch(e) {
                alert("Database connection failed!");
                btn.innerText = "Try Again";
            }
        }

        setInterval(checkStatus, 5000);
        checkStatus();
    </script>
</body>
</html>
